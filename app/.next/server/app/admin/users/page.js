(()=>{var e={};e.id=9674,e.ids=[9674],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},65357:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>r.a,__next_app__:()=>m,originalPathname:()=>o,pages:()=>x,routeModule:()=>h,tree:()=>d}),a(89049),a(3641),a(35866);var t=a(23191),l=a(88716),i=a(37922),r=a.n(i),n=a(95231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);a.d(s,c);let d=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,89049)),"/home/ubuntu/sully-booking-system/app/app/admin/users/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3641)),"/home/ubuntu/sully-booking-system/app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],x=["/home/ubuntu/sully-booking-system/app/app/admin/users/page.tsx"],o="/admin/users/page",m={require:a,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},20710:(e,s,a)=>{Promise.resolve().then(a.bind(a,52934))},52934:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>_});var t=a(10326),l=a(17577),i=a(70209),r=a(35047),n=a(33071),c=a(90772),d=a(567),x=a(54432),o=a(34474),m=a(15940),h=a(62288),u=a(99440),j=a(86333),p=a(41137),g=a(88307),v=a(24061),f=a(12714);let y=(0,a(62881).Z)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var N=a(59819),b=a(98091),w=a(11890),A=a(39183),C=a(90434),k=a(16856),S=a(85999);function _(){let{user:e,loading:s}=(0,i.a)();(0,r.useRouter)();let[a,_]=(0,l.useState)([]),[E,P]=(0,l.useState)({page:1,limit:10,total:0,pages:0}),[U,V]=(0,l.useState)(!0),[F,Z]=(0,l.useState)(""),[R,z]=(0,l.useState)("all"),[D,M]=(0,l.useState)(null),[L,O]=(0,l.useState)(!1),[q,T]=(0,l.useState)(!1),[I,$]=(0,l.useState)(null),B=async()=>{try{V(!0);let e=new URLSearchParams({page:E.page.toString(),limit:E.limit.toString()});"all"!==R&&e.append("role",R);let s=await fetch(`/api/admin/users?${e}`);if(s.ok){let e=await s.json();_(e.users),P(e.pagination)}else S.A.error("Failed to fetch users")}catch(e){console.error("Failed to fetch users:",e),S.A.error("Failed to fetch users")}finally{V(!1)}},Q=async(e,s)=>{try{(await fetch(`/api/admin/users/${e}/toggle-status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!s})})).ok?(S.A.success(`User ${s?"disabled":"enabled"} successfully`),B()):S.A.error("Failed to update user status")}catch(e){console.error("Failed to toggle user status:",e),S.A.error("Failed to update user status")}},G=async e=>{try{(await fetch(`/api/admin/users/${e}`,{method:"DELETE"})).ok?(S.A.success("User deleted successfully"),B(),T(!1),$(null)):S.A.error("Failed to delete user")}catch(e){console.error("Failed to delete user:",e),S.A.error("Failed to delete user")}},H=a.filter(e=>e.firstName.toLowerCase().includes(F.toLowerCase())||e.lastName.toLowerCase().includes(F.toLowerCase())||e.email.toLowerCase().includes(F.toLowerCase())),J=e=>{switch(e){case"SUPER_ADMIN":return"bg-red-100 text-red-800";case"VENUE_OWNER":return"bg-blue-100 text-blue-800";case"VENUE_STAFF":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return s||!e||"SUPER_ADMIN"!==e.role?t.jsx("div",{className:"min-h-screen flex items-center justify-center",children:t.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[t.jsx("header",{className:"bg-white shadow-sm border-b",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"flex justify-between items-center h-16",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(C.default,{href:"/admin",className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[t.jsx(j.Z,{className:"h-5 w-5"}),t.jsx("span",{children:"Back to Admin"})]}),t.jsx("div",{className:"h-6 w-px bg-gray-300"}),t.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"User Management"})]})})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsx(k.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-6",children:(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:(0,t.jsxs)(n.ll,{className:"flex items-center space-x-2",children:[t.jsx(p.Z,{className:"h-5 w-5"}),t.jsx("span",{children:"Filters & Search"})]})}),t.jsx(n.aY,{children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsx("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[t.jsx(g.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),t.jsx(x.I,{placeholder:"Search users by name or email...",value:F,onChange:e=>Z(e.target.value),className:"pl-10"})]})}),t.jsx("div",{className:"w-full md:w-48",children:(0,t.jsxs)(o.Ph,{value:R,onValueChange:z,children:[t.jsx(o.i4,{children:t.jsx(o.ki,{placeholder:"Filter by role"})}),(0,t.jsxs)(o.Bw,{children:[t.jsx(o.Ql,{value:"all",children:"All Roles"}),t.jsx(o.Ql,{value:"SUPER_ADMIN",children:"Super Admin"}),t.jsx(o.Ql,{value:"VENUE_OWNER",children:"Venue Owner"}),t.jsx(o.Ql,{value:"VENUE_STAFF",children:"Venue Staff"}),t.jsx(o.Ql,{value:"CUSTOMER",children:"Customer"})]})]})})]})})]})}),t.jsx(k.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1},children:(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:t.jsx(n.ll,{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(v.Z,{className:"h-5 w-5"}),(0,t.jsxs)("span",{children:["Users (",E.total,")"]})]})})}),t.jsx(n.aY,{children:U?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,t.jsxs)(t.Fragment,{children:[t.jsx("div",{className:"overflow-x-auto",children:(0,t.jsxs)(m.iA,{children:[t.jsx(m.xD,{children:(0,t.jsxs)(m.SC,{children:[t.jsx(m.ss,{children:"User"}),t.jsx(m.ss,{children:"Role"}),t.jsx(m.ss,{children:"Status"}),t.jsx(m.ss,{children:"Venues"}),t.jsx(m.ss,{children:"Bookings"}),t.jsx(m.ss,{children:"Joined"}),t.jsx(m.ss,{children:"Actions"})]})}),t.jsx(m.RM,{children:H.map(e=>(0,t.jsxs)(m.SC,{children:[t.jsx(m.pj,{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:[e.firstName," ",e.lastName]}),t.jsx("div",{className:"text-sm text-gray-500",children:e.email}),e.phone&&t.jsx("div",{className:"text-sm text-gray-500",children:e.phone})]})}),t.jsx(m.pj,{children:t.jsx(d.C,{className:J(e.role),children:e.role.replace("_"," ")})}),t.jsx(m.pj,{children:(0,t.jsxs)("div",{className:"flex flex-col space-y-1",children:[t.jsx(d.C,{variant:e.isActive?"default":"destructive",children:e.isActive?"Active":"Inactive"}),e.emailVerified&&t.jsx(d.C,{variant:"outline",className:"text-xs",children:"Verified"})]})}),t.jsx(m.pj,{children:e._count.venues}),t.jsx(m.pj,{children:e._count.bookings}),t.jsx(m.pj,{children:new Date(e.createdAt).toLocaleDateString()}),t.jsx(m.pj,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(c.z,{variant:"outline",size:"sm",onClick:()=>{M(e),O(!0)},children:t.jsx(f.Z,{className:"h-4 w-4"})}),t.jsx(c.z,{variant:e.isActive?"destructive":"default",size:"sm",onClick:()=>Q(e.id,e.isActive),children:e.isActive?t.jsx(y,{className:"h-4 w-4"}):t.jsx(N.Z,{className:"h-4 w-4"})}),t.jsx(c.z,{variant:"destructive",size:"sm",onClick:()=>{$(e),T(!0)},children:t.jsx(b.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),E.pages>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between mt-6",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Showing ",(E.page-1)*E.limit+1," to"," ",Math.min(E.page*E.limit,E.total)," of"," ",E.total," users"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>P(e=>({...e,page:e.page-1})),disabled:1===E.page,children:[t.jsx(w.Z,{className:"h-4 w-4"}),"Previous"]}),(0,t.jsxs)("span",{className:"text-sm",children:["Page ",E.page," of ",E.pages]}),(0,t.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>P(e=>({...e,page:e.page+1})),disabled:E.page===E.pages,children:["Next",t.jsx(A.Z,{className:"h-4 w-4"})]})]})]})]})})]})})]}),t.jsx(h.Vq,{open:L,onOpenChange:O,children:(0,t.jsxs)(h.cZ,{className:"max-w-2xl",children:[(0,t.jsxs)(h.fK,{children:[t.jsx(h.$N,{children:"User Details"}),t.jsx(h.Be,{children:"Detailed information about the selected user"})]}),D&&t.jsx("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Name"}),(0,t.jsxs)("p",{className:"text-sm",children:[D.firstName," ",D.lastName]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),t.jsx("p",{className:"text-sm",children:D.email})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phone"}),t.jsx("p",{className:"text-sm",children:D.phone||"Not provided"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Role"}),t.jsx(d.C,{className:J(D.role),children:D.role.replace("_"," ")})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),t.jsx(d.C,{variant:D.isActive?"default":"destructive",children:D.isActive?"Active":"Inactive"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email Verified"}),t.jsx(d.C,{variant:D.emailVerified?"default":"secondary",children:D.emailVerified?"Verified":"Not Verified"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Venues"}),t.jsx("p",{className:"text-sm",children:D._count.venues})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Bookings"}),t.jsx("p",{className:"text-sm",children:D._count.bookings})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Joined"}),t.jsx("p",{className:"text-sm",children:new Date(D.createdAt).toLocaleDateString()})]})]})}),t.jsx(h.cN,{children:t.jsx(c.z,{variant:"outline",onClick:()=>O(!1),children:"Close"})})]})}),t.jsx(u.aR,{open:q,onOpenChange:T,children:(0,t.jsxs)(u._T,{children:[(0,t.jsxs)(u.fY,{children:[t.jsx(u.f$,{children:"Delete User"}),(0,t.jsxs)(u.yT,{children:["Are you sure you want to delete ",I?.firstName," ",I?.lastName,"? This action cannot be undone and will also delete all associated data."]})]}),(0,t.jsxs)(u.xo,{children:[t.jsx(u.le,{onClick:()=>$(null),children:"Cancel"}),t.jsx(u.OL,{onClick:()=>I&&G(I.id),className:"bg-red-600 hover:bg-red-700",children:"Delete User"})]})]})})]})}},59819:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]])},89049:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(68570).createProxy)(String.raw`/home/ubuntu/sully-booking-system/app/app/admin/users/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[9276,6003,434,6856,7523,698,5864,1597],()=>a(65357));module.exports=t})();