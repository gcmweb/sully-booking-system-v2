(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8870],{1106:function(e,a,s){Promise.resolve().then(s.bind(s,4664))},4664:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return B}});var i=s(7437),t=s(2265),l=s(6413),n=s(9376),r=s(6070),c=s(2869),d=s(5974),o=s(5186),u=s(6815),m=s(6818),h=s(3647),x=s(1828),p=s(2660),g=s(8501),v=s(5805),j=s(8728),f=s(3774),y=s(3041),N=s(3229),b=s(1723),w=s(7648),E=s(429),D=s(5153),I=s(987),F=s(2339),C=s(3113),k=s(8617),T=s(5598),U=s(2489),S=s(1817),Z=s(7689),V=s(3145);function O(e){let{onUpload:a,currentImage:s,onRemove:l,disabled:n=!1,accept:o="image/*",maxSize:u=5242880,className:m="",label:h="Upload Image",description:x="Drag and drop an image here, or click to select",aspectRatio:p="aspect-video"}=e,[g,v]=(0,t.useState)(!1),{toast:j}=(0,D.pm)(),f=(0,t.useCallback)(async e=>{if(0===e.length)return;let s=e[0];if(s.size>u){j({title:"File too large",description:"Maximum file size is ".concat(Math.round(u/1024/1024),"MB"),variant:"destructive"});return}v(!0);try{let e=new FormData;e.append("file",s);let i=await fetch("/api/upload",{method:"POST",body:e});if(!i.ok){let e=await i.json();throw Error(e.error||"Upload failed")}let t=await i.json();a(t.url),j({title:"Upload successful",description:"Your image has been uploaded successfully."})}catch(e){console.error("Upload error:",e),j({title:"Upload failed",description:e.message||"Failed to upload image",variant:"destructive"})}finally{v(!1)}},[a,u,j]),{getRootProps:y,getInputProps:N,isDragActive:b}=(0,T.uI)({onDrop:f,accept:{"image/*":[".jpeg",".jpg",".png",".webp"]},maxFiles:1,disabled:n||g});return(0,i.jsxs)("div",{className:"space-y-4 ".concat(m),children:[h&&(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:h}),x&&(0,i.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:x})]}),s?(0,i.jsx)(r.Zb,{children:(0,i.jsx)(r.aY,{className:"p-4",children:(0,i.jsxs)("div",{className:"relative ".concat(p," bg-gray-100 rounded-lg overflow-hidden"),children:[(0,i.jsx)(V.default,{src:s,alt:"Uploaded image",fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"}),l&&(0,i.jsx)(c.z,{variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{l&&l()},disabled:n,children:(0,i.jsx)(U.Z,{className:"h-4 w-4"})})]})})}):(0,i.jsx)(r.Zb,{children:(0,i.jsx)(r.aY,{className:"p-0",children:(0,i.jsxs)("div",{...y(),className:"\n                ".concat(p," border-2 border-dashed rounded-lg cursor-pointer transition-colors\n                ").concat(b?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400","\n                ").concat(n||g?"cursor-not-allowed opacity-50":"","\n              "),children:[(0,i.jsx)("input",{...N()}),(0,i.jsx)("div",{className:"h-full flex flex-col items-center justify-center p-6 text-center",children:g?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(S.Z,{className:"h-8 w-8 text-blue-500 animate-spin mb-4"}),(0,i.jsx)("p",{className:"text-sm text-gray-600",children:"Uploading..."})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Z.Z,{className:"h-8 w-8 text-gray-400 mb-4"}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:b?"Drop the image here":"Drag and drop an image here"}),(0,i.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"or click to select from your computer"}),(0,i.jsxs)(d.C,{variant:"secondary",className:"text-xs",children:["JPEG, PNG, WebP up to ",Math.round(u/1024/1024),"MB"]})]})})]})})})]})}var _=s(6110),P=s(9397),A=s(5868),R=s(8930);let z=[{value:"MENU",label:"Menu"},{value:"FOOD",label:"Food"},{value:"INTERIOR",label:"Interior"},{value:"EXTERIOR",label:"Exterior"},{value:"STAFF",label:"Staff"},{value:"EVENT",label:"Event"},{value:"OTHER",label:"Other"}];function Y(e){let{venueId:a,canUpload:s,maxImages:l,disabled:n=!1}=e,[m,x]=(0,t.useState)([]),[p,g]=(0,t.useState)(!0),[v,j]=(0,t.useState)(!1),[f,y]=(0,t.useState)(null),[N,b]=(0,t.useState)({url:"",alt:"",type:"FOOD"}),[w,E]=(0,t.useState)(!1),{toast:I}=(0,D.pm)();(0,t.useEffect)(()=>{F()},[a]);let F=async()=>{try{let e=await fetch("/api/venues/".concat(a,"/images"),{credentials:"include"});if(e.ok){let a=await e.json();x(a.images||[])}else console.error("Failed to fetch images")}catch(e){console.error("Error fetching images:",e)}finally{g(!1)}},k=async e=>{b(a=>({...a,url:e}))},T=async()=>{if(!N.url||!N.type){I({title:"Missing information",description:"Please upload an image and select a type.",variant:"destructive"});return}j(!0);try{let e=await fetch("/api/venues/".concat(a,"/images"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({url:N.url,alt:N.alt,type:N.type,displayOrder:m.length})});if(e.ok){let a=await e.json();x(e=>[...e,a.image]),b({url:"",alt:"",type:"FOOD"}),E(!1),I({title:"Image added",description:"Your image has been added to the gallery."})}else{let a=await e.json();throw Error(a.error||"Failed to add image")}}catch(e){I({title:"Failed to add image",description:e.message,variant:"destructive"})}finally{j(!1)}},U=async e=>{try{let s=await fetch("/api/venues/".concat(a,"/images/").concat(e),{method:"DELETE",credentials:"include"});if(s.ok)x(a=>a.filter(a=>a.id!==e)),I({title:"Image deleted",description:"The image has been removed from your gallery."});else{let e=await s.json();throw Error(e.error||"Failed to delete image")}}catch(e){I({title:"Failed to delete image",description:e.message,variant:"destructive"})}},S=async()=>{if(f)try{let e=await fetch("/api/venues/".concat(a,"/images/").concat(f.id),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({alt:f.alt,type:f.type})});if(e.ok){let a=await e.json();x(e=>e.map(e=>e.id===f.id?a.image:e)),y(null),I({title:"Image updated",description:"Your image details have been updated."})}else{let a=await e.json();throw Error(a.error||"Failed to update image")}}catch(e){I({title:"Failed to update image",description:e.message,variant:"destructive"})}};return p?(0,i.jsxs)(r.Zb,{children:[(0,i.jsx)(r.Ol,{children:(0,i.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,i.jsx)(C.Z,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:"Image Gallery"})]})}),(0,i.jsx)(r.aY,{children:(0,i.jsx)("div",{className:"animate-pulse space-y-4",children:(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[1,2,3].map(e=>(0,i.jsx)("div",{className:"aspect-square bg-gray-200 rounded-lg"},e))})})})]}):s?(0,i.jsxs)(r.Zb,{children:[(0,i.jsx)(r.Ol,{children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,i.jsx)(C.Z,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:"Image Gallery"}),(0,i.jsxs)(d.C,{variant:"secondary",children:[m.length,"/",l]})]}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Showcase your venue with beautiful images"})]}),m.length<l&&(0,i.jsxs)(_.Vq,{open:w,onOpenChange:E,children:[(0,i.jsx)(_.hg,{asChild:!0,children:(0,i.jsxs)(c.z,{disabled:n,children:[(0,i.jsx)(P.Z,{className:"h-4 w-4 mr-2"}),"Add Image"]})}),(0,i.jsxs)(_.cZ,{className:"max-w-2xl",children:[(0,i.jsx)(_.fK,{children:(0,i.jsx)(_.$N,{children:"Add New Image"})}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsx)(O,{onUpload:k,currentImage:N.url,onRemove:()=>b(e=>({...e,url:""})),disabled:v,aspectRatio:"aspect-video"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"imageType",children:"Image Type"}),(0,i.jsxs)(h.Ph,{value:N.type,onValueChange:e=>b(a=>({...a,type:e})),children:[(0,i.jsx)(h.i4,{children:(0,i.jsx)(h.ki,{placeholder:"Select image type"})}),(0,i.jsx)(h.Bw,{children:z.map(e=>(0,i.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"imageAlt",children:"Description (Optional)"}),(0,i.jsx)(o.I,{id:"imageAlt",placeholder:"Describe the image...",value:N.alt,onChange:e=>b(a=>({...a,alt:e.target.value}))})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,i.jsx)(c.z,{variant:"outline",onClick:()=>E(!1),disabled:v,children:"Cancel"}),(0,i.jsx)(c.z,{onClick:T,disabled:v||!N.url,children:v?"Adding...":"Add Image"})]})]})]})]})]})}),(0,i.jsx)(r.aY,{children:0===m.length?(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)(C.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No images yet"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"Start building your gallery by adding your first image"})]}):(0,i.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:m.map(e=>{var a;return(0,i.jsxs)("div",{className:"group relative",children:[(0,i.jsx)("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:(0,i.jsx)(V.default,{src:e.url,alt:e.alt||"Venue image",fill:!0,className:"object-cover group-hover:scale-105 transition-transform duration-200",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"})}),(0,i.jsx)("div",{className:"absolute top-2 left-2",children:(0,i.jsx)(d.C,{variant:"secondary",className:"text-xs",children:(null===(a=z.find(a=>a.value===e.type))||void 0===a?void 0:a.label)||e.type})}),(0,i.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,i.jsxs)("div",{className:"flex space-x-1",children:[(0,i.jsx)(c.z,{size:"sm",variant:"secondary",onClick:()=>y(e),disabled:n,children:(0,i.jsx)(A.Z,{className:"h-3 w-3"})}),(0,i.jsx)(c.z,{size:"sm",variant:"destructive",onClick:()=>U(e.id),disabled:n,children:(0,i.jsx)(R.Z,{className:"h-3 w-3"})})]})})]},e.id)})})}),(0,i.jsx)(_.Vq,{open:!!f,onOpenChange:()=>y(null),children:(0,i.jsxs)(_.cZ,{children:[(0,i.jsx)(_.fK,{children:(0,i.jsx)(_.$N,{children:"Edit Image"})}),f&&(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("div",{className:"aspect-video bg-gray-100 rounded-lg overflow-hidden relative",children:(0,i.jsx)(V.default,{src:f.url,alt:f.alt||"Venue image",fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, 50vw"})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"editImageType",children:"Image Type"}),(0,i.jsxs)(h.Ph,{value:f.type,onValueChange:e=>y(a=>a?{...a,type:e}:null),children:[(0,i.jsx)(h.i4,{children:(0,i.jsx)(h.ki,{})}),(0,i.jsx)(h.Bw,{children:z.map(e=>(0,i.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"editImageAlt",children:"Description"}),(0,i.jsx)(o.I,{id:"editImageAlt",placeholder:"Describe the image...",value:f.alt||"",onChange:e=>y(a=>a?{...a,alt:e.target.value}:null)})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,i.jsx)(c.z,{variant:"outline",onClick:()=>y(null),children:"Cancel"}),(0,i.jsx)(c.z,{onClick:S,children:"Update Image"})]})]})]})})]}):(0,i.jsxs)(r.Zb,{children:[(0,i.jsx)(r.Ol,{children:(0,i.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,i.jsx)(C.Z,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:"Image Gallery"}),(0,i.jsx)(d.C,{variant:"outline",children:"Premium Feature"})]})}),(0,i.jsx)(r.aY,{children:(0,i.jsxs)("div",{className:"text-center py-8",children:[(0,i.jsx)(C.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,i.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upgrade to Premium"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload gallery images to showcase your venue, menu, and atmosphere with a Premium subscription."}),(0,i.jsx)(c.z,{children:"Upgrade Now"})]})})]})}function M(e){let{venueId:a,currentLogo:s,currentHeaderImage:l,disabled:n=!1}=e,[c,o]=(0,t.useState)(null),[u,m]=(0,t.useState)(s),[h,x]=(0,t.useState)(l),[p,g]=(0,t.useState)(!0),{toast:v}=(0,D.pm)();(0,t.useEffect)(()=>{j()},[a]);let j=async()=>{try{let i=await fetch("/api/venues/".concat(a),{credentials:"include"});if(i.ok){var e,s;let a=await i.json(),t=(null===(s=a.venue)||void 0===s?void 0:null===(e=s.subscription)||void 0===e?void 0:e.plan)||"FREE";o({canUploadLogo:!0,canUploadHeader:!0,canUploadGallery:"PREMIUM"===t||"PAID"===t,maxGalleryImages:"PREMIUM"===t||"PAID"===t?20:0,plan:t})}}catch(e){console.error("Error fetching permissions:",e)}finally{g(!1)}},f=async e=>{try{let s=await fetch("/api/venues/".concat(a,"/logo"),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({logoUrl:e})});if(s.ok)m(e),v({title:"Logo updated",description:"Your venue logo has been updated successfully."});else{let e=await s.json();throw Error(e.error||"Failed to update logo")}}catch(e){v({title:"Failed to update logo",description:e.message,variant:"destructive"})}},y=async()=>{try{let e=await fetch("/api/venues/".concat(a,"/logo"),{method:"DELETE",credentials:"include"});if(e.ok)m(void 0),v({title:"Logo removed",description:"Your venue logo has been removed."});else{let a=await e.json();throw Error(a.error||"Failed to remove logo")}}catch(e){v({title:"Failed to remove logo",description:e.message,variant:"destructive"})}},N=async e=>{try{let s=await fetch("/api/venues/".concat(a,"/header-image"),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({headerImageUrl:e})});if(s.ok)x(e),v({title:"Header image updated",description:"Your venue header image has been updated successfully."});else{let e=await s.json();throw Error(e.error||"Failed to update header image")}}catch(e){v({title:"Failed to update header image",description:e.message,variant:"destructive"})}},b=async()=>{try{let e=await fetch("/api/venues/".concat(a,"/header-image"),{method:"DELETE",credentials:"include"});if(e.ok)x(void 0),v({title:"Header image removed",description:"Your venue header image has been removed."});else{let a=await e.json();throw Error(a.error||"Failed to remove header image")}}catch(e){v({title:"Failed to remove header image",description:e.message,variant:"destructive"})}};return p?(0,i.jsxs)(r.Zb,{children:[(0,i.jsx)(r.Ol,{children:(0,i.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,i.jsx)(C.Z,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:"Venue Images"})]})}),(0,i.jsx)(r.aY,{children:(0,i.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,i.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"}),(0,i.jsx)("div",{className:"h-32 bg-gray-200 rounded-lg"})]})})]}):c?(0,i.jsxs)(r.Zb,{children:[(0,i.jsx)(r.Ol,{children:(0,i.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,i.jsx)(C.Z,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:"Venue Images"}),(0,i.jsx)(d.C,{variant:"outline",className:"flex items-center space-x-1",children:"PREMIUM"===c.plan||"PAID"===c.plan?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(k.Z,{className:"h-3 w-3"}),(0,i.jsx)("span",{children:c.plan})]}):(0,i.jsx)("span",{children:"FREE"})})]})}),(0,i.jsx)(r.aY,{children:(0,i.jsxs)(F.mQ,{defaultValue:"basic",className:"space-y-6",children:[(0,i.jsxs)(F.dr,{className:"grid w-full grid-cols-2",children:[(0,i.jsx)(F.SP,{value:"basic",children:"Logo & Header"}),(0,i.jsx)(F.SP,{value:"gallery",children:"Gallery"})]}),(0,i.jsx)(F.nU,{value:"basic",className:"space-y-6",children:(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsx)(O,{onUpload:f,currentImage:u,onRemove:y,disabled:n||!c.canUploadLogo,label:"Venue Logo",description:"Upload your venue logo (recommended: square format)",aspectRatio:"aspect-square"}),(0,i.jsx)(O,{onUpload:N,currentImage:h,onRemove:b,disabled:n||!c.canUploadHeader,label:"Header Image",description:"Upload a header image for your venue profile",aspectRatio:"aspect-video"})]})}),(0,i.jsx)(F.nU,{value:"gallery",children:(0,i.jsx)(Y,{venueId:a,canUpload:c.canUploadGallery,maxImages:c.maxGalleryImages,disabled:n})})]})})]}):(0,i.jsxs)(r.Zb,{children:[(0,i.jsx)(r.Ol,{children:(0,i.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,i.jsx)(C.Z,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:"Venue Images"})]})}),(0,i.jsx)(r.aY,{children:(0,i.jsx)("p",{className:"text-gray-600",children:"Unable to load image permissions."})})]})}let q=[{value:"RESTAURANT",label:"Restaurant"},{value:"CAFE",label:"Cafe"},{value:"BAR",label:"Bar"},{value:"PUB",label:"Pub"},{value:"FOOD_TRUCK",label:"Food Truck"},{value:"FINE_DINING",label:"Fine Dining"},{value:"FAST_CASUAL",label:"Fast Casual"},{value:"BAKERY",label:"Bakery"},{value:"OTHER",label:"Other"}];function B(){var e,a,s,F,C;let{user:k,loading:T}=(0,l.a)(),U=(0,n.useRouter)(),S=(0,n.useParams)(),{toast:Z}=(0,D.pm)(),V=S.id,[O,_]=(0,t.useState)(null),[P,A]=(0,t.useState)(!0),[R,z]=(0,t.useState)(!1),[Y,B]=(0,t.useState)(!1),[H,G]=(0,t.useState)([]),[L,J]=(0,t.useState)({name:"",description:"",address:"",city:"",postcode:"",phone:"",email:"",website:"",cuisine:"",venueType:"",capacity:"",isActive:!0});(0,t.useEffect)(()=>{T||k||U.push("/auth/login")},[k,T,U]),(0,t.useEffect)(()=>{k&&V&&K()},[k,V]);let K=async()=>{try{let a=await fetch("/api/venues/".concat(V),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(a.ok){var e;let s=await a.json();_(s.venue),J({name:s.venue.name||"",description:s.venue.description||"",address:s.venue.address||"",city:s.venue.city||"",postcode:s.venue.postcode||"",phone:s.venue.phone||"",email:s.venue.email||"",website:s.venue.website||"",cuisine:s.venue.cuisine||"",venueType:s.venue.venueType||"",capacity:(null===(e=s.venue.capacity)||void 0===e?void 0:e.toString())||"",isActive:s.venue.isActive}),Q()}else 404===a.status?(Z({title:"Venue not found",description:"The venue you are looking for does not exist.",variant:"destructive"}),U.push("/dashboard/venues")):(console.error("Failed to fetch venue:",a.status),Z({title:"Error",description:"Failed to load venue details.",variant:"destructive"}))}catch(e){console.error("Network error fetching venue:",e),Z({title:"Error",description:"Network error while loading venue details.",variant:"destructive"})}finally{A(!1)}},Q=async()=>{try{let e=await fetch("/api/venues/".concat(V,"/opening-hours"),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){let a=await e.json();G(a.openingHours||[])}}catch(e){console.error("Failed to fetch opening hours:",e)}},$=e=>{J({...L,[e.target.name]:e.target.value})},W=async()=>{if(!H||0===H.length){Z({title:"No opening hours to save",description:"Please add some opening hours before saving.",variant:"destructive"});return}B(!0),console.log("\uD83D\uDD35 [VENUE_EDIT] Saving opening hours separately:",H);try{let e=await fetch("/api/venues/".concat(V,"/opening-hours"),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({openingHours:H})});if(e.ok){let a=await e.json();console.log("\uD83D\uDFE2 [VENUE_EDIT] Opening hours saved successfully:",a),await Q(),Z({title:"Opening hours saved!",description:"Your opening hours have been updated successfully."})}else{let a=await e.text();console.error("\uD83D\uDD34 [VENUE_EDIT] Failed to save opening hours:",e.status,a),Z({title:"Failed to save opening hours",description:"There was an error saving your opening hours. Please try again.",variant:"destructive"})}}catch(e){console.error("\uD83D\uDD34 [VENUE_EDIT] Network error saving opening hours:",e),Z({title:"Network error",description:"Failed to save opening hours due to network error. Please try again.",variant:"destructive"})}finally{B(!1),console.log("\uD83D\uDD35 [VENUE_EDIT] Opening hours save operation completed")}},X=async e=>{e.preventDefault(),e.stopPropagation(),console.log("\uD83D\uDD35 [VENUE_EDIT] Form submission started"),z(!0);try{console.log("\uD83D\uDD35 [VENUE_EDIT] Updating venue details:",L);let e=await fetch("/api/venues/".concat(V),{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({...L,capacity:parseInt(L.capacity)})});if(e.ok){let a=await e.json();console.log("\uD83D\uDFE2 [VENUE_EDIT] Venue updated successfully:",a.venue),_(a.venue),Z({title:"Venue updated!",description:"Your venue details have been updated successfully."}),console.log("\uD83D\uDFE2 [VENUE_EDIT] Form submission completed successfully")}else{let a=await e.json();throw console.error("\uD83D\uDD34 [VENUE_EDIT] Venue update failed:",a),Error(a.error||"Failed to update venue")}}catch(e){console.error("\uD83D\uDD34 [VENUE_EDIT] Form submission error:",e),Z({title:"Failed to update venue",description:e.message,variant:"destructive"})}finally{z(!1),console.log("\uD83D\uDD35 [VENUE_EDIT] Form submission ended")}};return T||P?(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):O?(0,i.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,i.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,i.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,i.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)(w.default,{href:"/dashboard",className:"flex items-center space-x-2",children:[(0,i.jsx)(g.Z,{className:"h-8 w-8 text-blue-600"}),(0,i.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:"Sully"})]}),(0,i.jsx)(d.C,{variant:"secondary",children:"Venue Management"})]}),(0,i.jsx)(w.default,{href:"/dashboard/venues",children:(0,i.jsxs)(c.z,{variant:"outline",children:[(0,i.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Back to Venues"]})})]})})}),(0,i.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,i.jsx)(E.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-8",children:(0,i.jsxs)("div",{className:"flex justify-between items-start",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:O.name}),(0,i.jsx)("p",{className:"text-gray-600",children:"Manage your venue details and settings"})]}),(0,i.jsx)(d.C,{variant:O.isActive?"default":"secondary",className:"text-sm",children:O.isActive?"Active":"Inactive"})]})}),(0,i.jsxs)(E.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1},className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,i.jsxs)(r.Zb,{children:[(0,i.jsxs)(r.Ol,{className:"flex flex-row items-center space-y-0 pb-2",children:[(0,i.jsx)(r.ll,{className:"text-sm font-medium",children:"Total Bookings"}),(0,i.jsx)(g.Z,{className:"h-4 w-4 ml-auto text-blue-600"})]}),(0,i.jsxs)(r.aY,{children:[(0,i.jsx)("div",{className:"text-2xl font-bold",children:(null===(e=O._count)||void 0===e?void 0:e.bookings)||0}),(0,i.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null===(a=O.subscription)||void 0===a?void 0:a.bookingsUsed)||0,"/",(null===(s=O.subscription)||void 0===s?void 0:s.bookingsLimit)||"∞"," this period"]})]})]}),(0,i.jsxs)(r.Zb,{children:[(0,i.jsxs)(r.Ol,{className:"flex flex-row items-center space-y-0 pb-2",children:[(0,i.jsx)(r.ll,{className:"text-sm font-medium",children:"Tables"}),(0,i.jsx)(v.Z,{className:"h-4 w-4 ml-auto text-green-600"})]}),(0,i.jsxs)(r.aY,{children:[(0,i.jsx)("div",{className:"text-2xl font-bold",children:(null===(F=O._count)||void 0===F?void 0:F.tables)||0}),(0,i.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Capacity: ",O.capacity," guests"]})]})]}),(0,i.jsxs)(r.Zb,{children:[(0,i.jsxs)(r.Ol,{className:"flex flex-row items-center space-y-0 pb-2",children:[(0,i.jsx)(r.ll,{className:"text-sm font-medium",children:"Subscription"}),(0,i.jsx)(j.Z,{className:"h-4 w-4 ml-auto text-purple-600"})]}),(0,i.jsxs)(r.aY,{children:[(0,i.jsx)("div",{className:"text-2xl font-bold",children:(null===(C=O.subscription)||void 0===C?void 0:C.plan)||"Unknown"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current plan"})]})]})]}),(0,i.jsx)(E.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:(0,i.jsxs)(r.Zb,{children:[(0,i.jsxs)(r.Ol,{children:[(0,i.jsx)(r.ll,{children:"Venue Details"}),(0,i.jsx)(r.SZ,{children:"Update your venue information and settings"})]}),(0,i.jsx)(r.aY,{children:(0,i.jsxs)("form",{onSubmit:X,className:"space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("h3",{className:"text-lg font-medium flex items-center",children:[(0,i.jsx)(j.Z,{className:"h-5 w-5 mr-2"}),"Basic Information"]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"name",children:"Venue Name *"}),(0,i.jsx)(o.I,{id:"name",name:"name",value:L.name,onChange:$,required:!0})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"venueType",children:"Venue Type *"}),(0,i.jsxs)(h.Ph,{value:L.venueType,onValueChange:e=>{J({...L,venueType:e})},required:!0,children:[(0,i.jsx)(h.i4,{children:(0,i.jsx)(h.ki,{placeholder:"Select venue type"})}),(0,i.jsx)(h.Bw,{children:q.map(e=>(0,i.jsx)(h.Ql,{value:e.value,children:e.label},e.value))})]})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"description",children:"Description"}),(0,i.jsx)(m.g,{id:"description",name:"description",value:L.description,onChange:$,rows:3})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"cuisine",children:"Cuisine Type"}),(0,i.jsx)(o.I,{id:"cuisine",name:"cuisine",value:L.cuisine,onChange:$})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"capacity",children:"Capacity *"}),(0,i.jsx)(o.I,{id:"capacity",name:"capacity",type:"number",value:L.capacity,onChange:$,required:!0})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(x.r,{id:"isActive",checked:L.isActive,onCheckedChange:e=>{J({...L,isActive:e})}}),(0,i.jsx)(u._,{htmlFor:"isActive",children:"Venue is active and accepting bookings"})]})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("h3",{className:"text-lg font-medium flex items-center",children:[(0,i.jsx)(f.Z,{className:"h-5 w-5 mr-2"}),"Location"]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"address",children:"Address *"}),(0,i.jsx)(o.I,{id:"address",name:"address",value:L.address,onChange:$,required:!0})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"city",children:"City *"}),(0,i.jsx)(o.I,{id:"city",name:"city",value:L.city,onChange:$,required:!0})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"postcode",children:"Postcode *"}),(0,i.jsx)(o.I,{id:"postcode",name:"postcode",value:L.postcode,onChange:$,required:!0})]})]})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("h3",{className:"text-lg font-medium flex items-center",children:[(0,i.jsx)(y.Z,{className:"h-5 w-5 mr-2"}),"Contact Information"]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"phone",children:"Phone Number *"}),(0,i.jsx)(o.I,{id:"phone",name:"phone",type:"tel",value:L.phone,onChange:$,required:!0})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"email",children:"Email Address *"}),(0,i.jsx)(o.I,{id:"email",name:"email",type:"email",value:L.email,onChange:$,required:!0})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(u._,{htmlFor:"website",children:"Website"}),(0,i.jsx)(o.I,{id:"website",name:"website",type:"url",value:L.website,onChange:$})]})]}),(0,i.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,i.jsx)(w.default,{href:"/dashboard/venues",children:(0,i.jsx)(c.z,{variant:"outline",children:"Cancel"})}),(0,i.jsxs)(c.z,{type:"submit",disabled:R,children:[(0,i.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),R?"Saving...":"Save Changes"]})]})]})})]})}),(0,i.jsx)(E.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.3},className:"mt-8",children:(0,i.jsxs)(r.Zb,{children:[(0,i.jsx)(r.Ol,{children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,i.jsx)(b.Z,{className:"h-5 w-5"}),(0,i.jsx)("span",{children:"Opening Hours"})]}),(0,i.jsx)(r.SZ,{children:"Set multiple time slots for each day of the week. Perfect for lunch and dinner services."})]}),(0,i.jsxs)(c.z,{onClick:W,disabled:Y||R,className:"flex items-center space-x-2",children:[(0,i.jsx)(N.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:Y?"Saving...":"Save Opening Hours"})]})]})}),(0,i.jsx)(r.aY,{children:(0,i.jsx)(I.Z,{openingHours:H,onChange:G,disabled:R||Y})})]})}),(0,i.jsx)(E.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},className:"mt-8",children:(0,i.jsx)(M,{venueId:V,currentLogo:O.logoUrl||void 0,currentHeaderImage:O.headerImageUrl||void 0,disabled:R||Y})})]})]}):(0,i.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Venue not found"}),(0,i.jsx)("p",{className:"text-gray-600 mb-4",children:"The venue you are looking for does not exist."}),(0,i.jsx)(w.default,{href:"/dashboard/venues",children:(0,i.jsxs)(c.z,{children:[(0,i.jsx)(p.Z,{className:"h-4 w-4 mr-2"}),"Back to Venues"]})})]})})}},6110:function(e,a,s){"use strict";s.d(a,{$N:function(){return p},Be:function(){return g},Vq:function(){return c},cN:function(){return x},cZ:function(){return m},fK:function(){return h},hg:function(){return d}});var i=s(7437),t=s(2265),l=s(9027),n=s(2489),r=s(4508);let c=l.fC,d=l.xz,o=l.h_;l.x8;let u=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,i.jsx)(l.aV,{ref:a,className:(0,r.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t})});u.displayName=l.aV.displayName;let m=t.forwardRef((e,a)=>{let{className:s,children:t,...c}=e;return(0,i.jsxs)(o,{children:[(0,i.jsx)(u,{}),(0,i.jsxs)(l.VY,{ref:a,className:(0,r.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...c,children:[t,(0,i.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,i.jsx)(n.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.VY.displayName;let h=e=>{let{className:a,...s}=e;return(0,i.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...s})};h.displayName="DialogHeader";let x=e=>{let{className:a,...s}=e;return(0,i.jsx)("div",{className:(0,r.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s})};x.displayName="DialogFooter";let p=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,i.jsx)(l.Dx,{ref:a,className:(0,r.cn)("text-lg font-semibold leading-none tracking-tight",s),...t})});p.displayName=l.Dx.displayName;let g=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,i.jsx)(l.dk,{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",s),...t})});g.displayName=l.dk.displayName},2339:function(e,a,s){"use strict";s.d(a,{SP:function(){return d},dr:function(){return c},mQ:function(){return r},nU:function(){return o}});var i=s(7437),t=s(2265),l=s(1312),n=s(4508);let r=l.fC,c=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,i.jsx)(l.aV,{ref:a,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...t})});c.displayName=l.aV.displayName;let d=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,i.jsx)(l.xz,{ref:a,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...t})});d.displayName=l.xz.displayName;let o=t.forwardRef((e,a)=>{let{className:s,...t}=e;return(0,i.jsx)(l.VY,{ref:a,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...t})});o.displayName=l.VY.displayName}},function(e){e.O(0,[8590,4671,429,1596,1345,3145,1312,6478,5013,7503,2971,2117,1744],function(){return e(e.s=1106)}),_N_E=e.O()}]);