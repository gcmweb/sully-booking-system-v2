(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4907],{1364:function(e,s,l){Promise.resolve().then(l.bind(l,4674))},4674:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return f}});var t=l(7437),a=l(2265),n=l(2869),i=l(5186),r=l(6070),c=l(3647),d=l(5974),o=l(8501),u=l(1723);let x=(0,l(9205).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var h=l(5805),m=l(3774),v=l(9345),j=l(3041),p=l(1671),y=l(9388),g=l(5153),N=l(429);function f(){let[e,s]=(0,a.useState)([]),[l,f]=(0,a.useState)([]),[b,k]=(0,a.useState)(!0),[w,C]=(0,a.useState)({venueId:"all",status:"all",search:""}),[E,A]=(0,a.useState)({page:1,limit:10,total:0,pages:0}),{toast:D}=(0,g.pm)();(0,a.useEffect)(()=>{I(),Z()},[w,E.page]);let I=async()=>{k(!0);try{let e=new URLSearchParams({page:E.page.toString(),limit:E.limit.toString(),...w.venueId&&"all"!==w.venueId&&{venueId:w.venueId},...w.status&&"all"!==w.status&&{status:w.status}}),l=await fetch("/api/bookings?".concat(e));if(l.ok){let e=await l.json(),t=Array.isArray(null==e?void 0:e.bookings)?e.bookings:[];s(t),A(s=>{var l,t;return{...s,total:(null==e?void 0:null===(l=e.pagination)||void 0===l?void 0:l.total)||0,pages:(null==e?void 0:null===(t=e.pagination)||void 0===t?void 0:t.pages)||0}})}else console.error("Failed to fetch bookings:",l.status,l.statusText),s([]),A(e=>({...e,total:0,pages:0}))}catch(e){console.error("Failed to fetch bookings:",e),s([]),A(e=>({...e,total:0,pages:0}))}finally{k(!1)}},Z=async()=>{try{let e=await fetch("/api/venues");if(e.ok){let s=await e.json(),l=Array.isArray(null==s?void 0:s.venues)?s.venues:[];f(l)}else console.error("Failed to fetch venues:",e.status,e.statusText),f([])}catch(e){console.error("Failed to fetch venues:",e),f([])}},O=async(l,t)=>{try{if((await fetch("/api/bookings/".concat(l,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok){let a=Array.isArray(e)?e:[];s(a.map(e=>(null==e?void 0:e.id)===l?{...e,status:t}:e)),D({title:"Booking updated",description:"Booking status changed to ".concat(t.toLowerCase(),".")})}else throw Error("Failed to update booking status")}catch(e){D({title:"Error",description:e.message,variant:"destructive"})}},M=e=>{switch(e){case"CONFIRMED":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"CANCELLED":return"bg-red-100 text-red-800";case"COMPLETED":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},P=e=>{switch(e){case"DINE_IN":return"Dine In";case"TAKEAWAY":return"Takeaway";case"DELIVERY":return"Delivery";case"EVENT":return"Event";default:return e}},S=e=>{switch(e){case"DIRECT":return"Direct";case"WIDGET":return"Widget";case"API":return"API";case"PHONE":return"Phone";case"WALK_IN":return"Walk-in";default:return e}},L=Array.isArray(e)?e:[],T=Array.isArray(l)?l:[],U=L.filter(e=>{try{if(!(null==e?void 0:e.date))return!1;let s=new Date(e.date),l=new Date;return s.toDateString()===l.toDateString()}catch(e){return!1}}),z=L.filter(e=>{try{if(!(null==e?void 0:e.date))return!1;let s=new Date(e.date),l=new Date;return s>l}catch(e){return!1}}),F=L.filter(e=>(null==e?void 0:e.status)==="PENDING");return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Bookings"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage all your venue bookings"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,t.jsx)(N.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Today's Bookings"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:U.length})]}),(0,t.jsx)(o.Z,{className:"h-8 w-8 text-blue-600"})]})})})}),(0,t.jsx)(N.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},children:(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:z.length})]}),(0,t.jsx)(u.Z,{className:"h-8 w-8 text-green-600"})]})})})}),(0,t.jsx)(N.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:F.length})]}),(0,t.jsx)(x,{className:"h-8 w-8 text-yellow-600"})]})})})}),(0,t.jsx)(N.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},children:(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Bookings"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:(null==E?void 0:E.total)||0})]}),(0,t.jsx)(h.Z,{className:"h-8 w-8 text-purple-600"})]})})})})]}),(0,t.jsx)(r.Zb,{children:(0,t.jsx)(r.aY,{className:"pt-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Search"}),(0,t.jsx)(i.I,{placeholder:"Customer name, email, or phone...",value:w.search,onChange:e=>C(s=>({...s,search:e.target.value}))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Venue"}),(0,t.jsxs)(c.Ph,{value:w.venueId,onValueChange:e=>C(s=>({...s,venueId:e})),children:[(0,t.jsx)(c.i4,{children:(0,t.jsx)(c.ki,{placeholder:"All venues"})}),(0,t.jsxs)(c.Bw,{children:[(0,t.jsx)(c.Ql,{value:"all",children:"All venues"}),T.filter(e=>(null==e?void 0:e.id)&&(null==e?void 0:e.name)).map(e=>(0,t.jsx)(c.Ql,{value:e.id,children:e.name},e.id))]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Status"}),(0,t.jsxs)(c.Ph,{value:w.status,onValueChange:e=>C(s=>({...s,status:e})),children:[(0,t.jsx)(c.i4,{children:(0,t.jsx)(c.ki,{placeholder:"All statuses"})}),(0,t.jsxs)(c.Bw,{children:[(0,t.jsx)(c.Ql,{value:"all",children:"All statuses"}),(0,t.jsx)(c.Ql,{value:"PENDING",children:"Pending"}),(0,t.jsx)(c.Ql,{value:"CONFIRMED",children:"Confirmed"}),(0,t.jsx)(c.Ql,{value:"CANCELLED",children:"Cancelled"}),(0,t.jsx)(c.Ql,{value:"COMPLETED",children:"Completed"}),(0,t.jsx)(c.Ql,{value:"NO_SHOW",children:"No Show"})]})]})]}),(0,t.jsx)("div",{className:"flex items-end",children:(0,t.jsx)(n.z,{onClick:()=>{C({venueId:"all",status:"all",search:""}),A(e=>({...e,page:1}))},children:"Clear Filters"})})]})})}),(0,t.jsxs)(r.Zb,{children:[(0,t.jsxs)(r.Ol,{children:[(0,t.jsx)(r.ll,{children:"All Bookings"}),(0,t.jsxs)(r.SZ,{children:[(null==E?void 0:E.total)||0," total bookings • Page ",(null==E?void 0:E.page)||1," of ",(null==E?void 0:E.pages)||1]})]}),(0,t.jsx)(r.aY,{children:b?(0,t.jsx)("div",{className:"space-y-4",children:Array.from({length:5}).map((e,s)=>(0,t.jsx)("div",{className:"animate-pulse",children:(0,t.jsx)("div",{className:"h-20 bg-gray-200 rounded"})},s))}):0===L.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(o.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No bookings found"}),(0,t.jsx)("p",{className:"text-gray-600",children:"No bookings match your current filters."})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[L.map((e,s)=>{var l,a;return(0,t.jsx)(N.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05*s},children:(0,t.jsx)(r.Zb,{className:"hover:shadow-md transition-shadow",children:(0,t.jsxs)(r.aY,{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:(null==e?void 0:e.customerName)||"Unknown Customer"}),(0,t.jsx)(d.C,{className:M((null==e?void 0:e.status)||"UNKNOWN"),children:(null==e?void 0:e.status)||"UNKNOWN"}),(0,t.jsx)(d.C,{variant:"outline",children:S((null==e?void 0:e.source)||"UNKNOWN")})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:(null==e?void 0:null===(l=e.venue)||void 0===l?void 0:l.name)||"Unknown Venue"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:(null==e?void 0:e.date)?new Date(e.date).toLocaleDateString():"Unknown Date"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:(null==e?void 0:e.time)||"Unknown Time"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.Z,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:[(null==e?void 0:e.partySize)||0," guests • ",P((null==e?void 0:e.serviceType)||"UNKNOWN")]})]})]}),(null==e?void 0:e.table)&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Table: ",e.table.name]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(v.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:(null==e?void 0:e.customerEmail)||"No email"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(j.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:(null==e?void 0:e.customerPhone)||"No phone"})]})]}),(null==e?void 0:e.specialRequests)&&(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[(0,t.jsx)("strong",{children:"Special requests:"})," ",e.specialRequests]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(null==e?void 0:e.status)==="PENDING"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.z,{size:"sm",onClick:()=>O(e.id,"CONFIRMED"),children:[(0,t.jsx)(p.Z,{className:"h-4 w-4 mr-1"}),"Confirm"]}),(0,t.jsxs)(n.z,{size:"sm",variant:"outline",onClick:()=>O(e.id,"CANCELLED"),children:[(0,t.jsx)(y.Z,{className:"h-4 w-4 mr-1"}),"Cancel"]})]}),(null==e?void 0:e.status)==="CONFIRMED"&&(0,t.jsxs)(c.Ph,{onValueChange:s=>O(e.id,s),children:[(0,t.jsx)(c.i4,{className:"w-32",children:(0,t.jsx)(c.ki,{placeholder:"Actions"})}),(0,t.jsxs)(c.Bw,{children:[(0,t.jsx)(c.Ql,{value:"COMPLETED",children:"Mark Complete"}),(0,t.jsx)(c.Ql,{value:"NO_SHOW",children:"Mark No Show"}),(0,t.jsx)(c.Ql,{value:"CANCELLED",children:"Cancel"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Booking ID: ",(null==e?void 0:null===(a=e.id)||void 0===a?void 0:a.slice(-8))||"Unknown"]}),(0,t.jsxs)("span",{children:["Created: ",(null==e?void 0:e.createdAt)?new Date(e.createdAt).toLocaleDateString():"Unknown"]})]})]})})},(null==e?void 0:e.id)||s)}),((null==E?void 0:E.pages)||0)>1&&(0,t.jsxs)("div",{className:"flex justify-center items-center space-x-2 mt-6",children:[(0,t.jsx)(n.z,{variant:"outline",disabled:1===((null==E?void 0:E.page)||1),onClick:()=>A(e=>({...e,page:Math.max(1,((null==e?void 0:e.page)||1)-1)})),children:"Previous"}),Array.from({length:Math.min(5,(null==E?void 0:E.pages)||0)},(e,s)=>{let l=s+1;return(0,t.jsx)(n.z,{variant:((null==E?void 0:E.page)||1)===l?"default":"outline",onClick:()=>A(e=>({...e,page:l})),children:l},l)}),(0,t.jsx)(n.z,{variant:"outline",disabled:((null==E?void 0:E.page)||1)===((null==E?void 0:E.pages)||1),onClick:()=>A(e=>({...e,page:Math.min((null==E?void 0:E.pages)||1,((null==e?void 0:e.page)||1)+1)})),children:"Next"})]})]})})]})]})}},8501:function(e,s,l){"use strict";l.d(s,{Z:function(){return t}});let t=(0,l(9205).Z)("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]])},9388:function(e,s,l){"use strict";l.d(s,{Z:function(){return t}});let t=(0,l(9205).Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},7712:function(e,s,l){"use strict";l.d(s,{j:function(){return n}});let t=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,a=function(){for(var e,s,l=0,t="";l<arguments.length;)(e=arguments[l++])&&(s=function e(s){var l,t,a="";if("string"==typeof s||"number"==typeof s)a+=s;else if("object"==typeof s){if(Array.isArray(s))for(l=0;l<s.length;l++)s[l]&&(t=e(s[l]))&&(a&&(a+=" "),a+=t);else for(l in s)s[l]&&(a&&(a+=" "),a+=l)}return a}(e))&&(t&&(t+=" "),t+=s);return t},n=(e,s)=>l=>{var n;if((null==s?void 0:s.variants)==null)return a(e,null==l?void 0:l.class,null==l?void 0:l.className);let{variants:i,defaultVariants:r}=s,c=Object.keys(i).map(e=>{let s=null==l?void 0:l[e],a=null==r?void 0:r[e];if(null===s)return null;let n=t(s)||t(a);return i[e][n]}),d=l&&Object.entries(l).reduce((e,s)=>{let[l,t]=s;return void 0===t||(e[l]=t),e},{});return a(e,c,null==s?void 0:null===(n=s.compoundVariants)||void 0===n?void 0:n.reduce((e,s)=>{let{class:l,className:t,...a}=s;return Object.entries(a).every(e=>{let[s,l]=e;return Array.isArray(l)?l.includes({...r,...d}[s]):({...r,...d})[s]===l})?[...e,l,t]:e},[]),null==l?void 0:l.class,null==l?void 0:l.className)}}},function(e){e.O(0,[8590,429,1596,1345,6430,2971,2117,1744],function(){return e(e.s=1364)}),_N_E=e.O()}]);