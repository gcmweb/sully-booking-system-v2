(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2504],{4411:function(e,s,a){Promise.resolve().then(a.bind(a,9499))},9499:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return E}});var t=a(7437),l=a(2265),i=a(6413),n=a(9376),r=a(6070),c=a(2869),d=a(5974),x=a(5186),o=a(3647),h=a(3578),m=a(6110),u=a(7099),j=a(2660),p=a(740),v=a(3247),f=a(44),y=a(3774),N=a(6595),g=a(5805),b=a(1047),w=a(2208),C=a(8930),A=a(2451),k=a(407),S=a(7648),F=a(429),Z=a(4438);function E(){let{user:e,loading:s}=(0,i.a)(),a=(0,n.useRouter)(),[E,T]=(0,l.useState)([]),[M,_]=(0,l.useState)({page:1,limit:10,total:0,pages:0}),[z,D]=(0,l.useState)(!0),[P,R]=(0,l.useState)(""),[I,O]=(0,l.useState)("all"),[L,B]=(0,l.useState)("all"),[V,Q]=(0,l.useState)(null),[U,Y]=(0,l.useState)(!1),[q,G]=(0,l.useState)(!1),[H,J]=(0,l.useState)(null);(0,l.useEffect)(()=>{s||e&&"SUPER_ADMIN"===e.role||a.push("/dashboard")},[e,s,a]),(0,l.useEffect)(()=>{e&&"SUPER_ADMIN"===e.role&&$()},[e,M.page,I,L]);let $=async()=>{try{D(!0);let e=new URLSearchParams({page:M.page.toString(),limit:M.limit.toString()});"all"!==I&&e.append("type",I),"all"!==L&&e.append("status",L);let s=await fetch("/api/admin/venues?".concat(e));if(s.ok){let e=await s.json();T(e.venues),_(e.pagination)}else Z.Am.error("Failed to fetch venues")}catch(e){console.error("Failed to fetch venues:",e),Z.Am.error("Failed to fetch venues")}finally{D(!1)}},K=async(e,s)=>{try{(await fetch("/api/admin/venues/".concat(e,"/toggle-status"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!s})})).ok?(Z.Am.success("Venue ".concat(s?"disabled":"enabled"," successfully")),$()):Z.Am.error("Failed to update venue status")}catch(e){console.error("Failed to toggle venue status:",e),Z.Am.error("Failed to update venue status")}},W=async(e,s)=>{try{let a=await fetch("/api/admin/venues/featured",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({venueId:e,featured:!s})}),t=await a.json();a.ok?(Z.Am.success(t.message),$()):Z.Am.error(t.error||"Failed to update featured status")}catch(e){console.error("Failed to toggle featured status:",e),Z.Am.error("Failed to update featured status")}},X=async e=>{try{(await fetch("/api/admin/venues/".concat(e),{method:"DELETE"})).ok?(Z.Am.success("Venue deleted successfully"),$(),G(!1),J(null)):Z.Am.error("Failed to delete venue")}catch(e){console.error("Failed to delete venue:",e),Z.Am.error("Failed to delete venue")}},ee=E.filter(e=>e.name.toLowerCase().includes(P.toLowerCase())||e.city.toLowerCase().includes(P.toLowerCase())||e.owner.firstName.toLowerCase().includes(P.toLowerCase())||e.owner.lastName.toLowerCase().includes(P.toLowerCase())),es=e=>{switch(e){case"RESTAURANT":return"bg-blue-100 text-blue-800";case"CAFE":return"bg-green-100 text-green-800";case"BAR":return"bg-purple-100 text-purple-800";case"PUB":return"bg-orange-100 text-orange-800";case"FINE_DINING":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return s||!e||"SUPER_ADMIN"!==e.role?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"flex justify-between items-center h-16",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(S.default,{href:"/admin",className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[(0,t.jsx)(j.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Back to Admin"})]}),(0,t.jsx)("div",{className:"h-6 w-px bg-gray-300"}),(0,t.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Venue Management"})]})})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)(F.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"mb-6",children:(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsxs)(r.ll,{className:"flex items-center space-x-2",children:[(0,t.jsx)(p.Z,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Filters & Search"})]})}),(0,t.jsx)(r.aY,{children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(v.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,t.jsx)(x.I,{placeholder:"Search venues by name, city, or owner...",value:P,onChange:e=>R(e.target.value),className:"pl-10"})]})}),(0,t.jsx)("div",{className:"w-full md:w-48",children:(0,t.jsxs)(o.Ph,{value:I,onValueChange:O,children:[(0,t.jsx)(o.i4,{children:(0,t.jsx)(o.ki,{placeholder:"Filter by type"})}),(0,t.jsxs)(o.Bw,{children:[(0,t.jsx)(o.Ql,{value:"all",children:"All Types"}),(0,t.jsx)(o.Ql,{value:"RESTAURANT",children:"Restaurant"}),(0,t.jsx)(o.Ql,{value:"CAFE",children:"Cafe"}),(0,t.jsx)(o.Ql,{value:"BAR",children:"Bar"}),(0,t.jsx)(o.Ql,{value:"PUB",children:"Pub"}),(0,t.jsx)(o.Ql,{value:"FINE_DINING",children:"Fine Dining"}),(0,t.jsx)(o.Ql,{value:"FAST_CASUAL",children:"Fast Casual"}),(0,t.jsx)(o.Ql,{value:"OTHER",children:"Other"})]})]})}),(0,t.jsx)("div",{className:"w-full md:w-48",children:(0,t.jsxs)(o.Ph,{value:L,onValueChange:B,children:[(0,t.jsx)(o.i4,{children:(0,t.jsx)(o.ki,{placeholder:"Filter by status"})}),(0,t.jsxs)(o.Bw,{children:[(0,t.jsx)(o.Ql,{value:"all",children:"All Status"}),(0,t.jsx)(o.Ql,{value:"active",children:"Active"}),(0,t.jsx)(o.Ql,{value:"inactive",children:"Inactive"})]})]})})]})})]})}),(0,t.jsx)(F.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.1},children:(0,t.jsxs)(r.Zb,{children:[(0,t.jsx)(r.Ol,{children:(0,t.jsx)(r.ll,{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(f.Z,{className:"h-5 w-5"}),(0,t.jsxs)("span",{children:["Venues (",M.total,")"]})]})})}),(0,t.jsx)(r.aY,{children:z?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(h.iA,{children:[(0,t.jsx)(h.xD,{children:(0,t.jsxs)(h.SC,{children:[(0,t.jsx)(h.ss,{children:"Venue"}),(0,t.jsx)(h.ss,{children:"Owner"}),(0,t.jsx)(h.ss,{children:"Type"}),(0,t.jsx)(h.ss,{children:"Status"}),(0,t.jsx)(h.ss,{children:"Featured"}),(0,t.jsx)(h.ss,{children:"Capacity"}),(0,t.jsx)(h.ss,{children:"Bookings"}),(0,t.jsx)(h.ss,{children:"Subscription"}),(0,t.jsx)(h.ss,{children:"Actions"})]})}),(0,t.jsx)(h.RM,{children:ee.map(e=>(0,t.jsxs)(h.SC,{children:[(0,t.jsx)(h.pj,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.name}),(0,t.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,t.jsx)(y.Z,{className:"h-3 w-3 mr-1"}),e.city,", ",e.postcode]}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})}),(0,t.jsx)(h.pj,{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:[e.owner.firstName," ",e.owner.lastName]}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.owner.email})]})}),(0,t.jsx)(h.pj,{children:(0,t.jsx)(d.C,{className:es(e.venueType),children:e.venueType.replace("_"," ")})}),(0,t.jsx)(h.pj,{children:(0,t.jsx)(d.C,{variant:e.isActive?"default":"destructive",children:e.isActive?"Active":"Inactive"})}),(0,t.jsx)(h.pj,{children:(0,t.jsx)("div",{className:"flex items-center space-x-2",children:(0,t.jsxs)(d.C,{variant:e.featured?"default":"outline",className:e.featured?"bg-yellow-100 text-yellow-800 border-yellow-300":"",children:[(0,t.jsx)(N.Z,{className:"h-3 w-3 mr-1 ".concat(e.featured?"fill-current":"")}),e.featured?"Featured":"Not Featured"]})})}),(0,t.jsx)(h.pj,{children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(g.Z,{className:"h-4 w-4 mr-1 text-gray-400"}),e.capacity]})}),(0,t.jsx)(h.pj,{children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(b.Z,{className:"h-4 w-4 mr-1 text-gray-400"}),e._count.bookings]})}),(0,t.jsx)(h.pj,{children:e.subscription?(0,t.jsx)(d.C,{variant:"ACTIVE"===e.subscription.status?"default":"secondary",children:e.subscription.plan}):(0,t.jsx)(d.C,{variant:"outline",children:"Free"})}),(0,t.jsx)(h.pj,{children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>{Q(e),Y(!0)},children:(0,t.jsx)(w.Z,{className:"h-4 w-4"})}),(0,t.jsx)(c.z,{variant:e.featured?"outline":"default",size:"sm",onClick:()=>W(e.id,e.featured),className:e.featured?"border-yellow-300 text-yellow-700 hover:bg-yellow-50":"",children:(0,t.jsx)(N.Z,{className:"h-4 w-4 ".concat(e.featured?"fill-current":"")})}),(0,t.jsx)(c.z,{variant:e.isActive?"destructive":"default",size:"sm",onClick:()=>K(e.id,e.isActive),children:e.isActive?"Disable":"Enable"}),(0,t.jsx)(c.z,{variant:"destructive",size:"sm",onClick:()=>{J(e),G(!0)},children:(0,t.jsx)(C.Z,{className:"h-4 w-4"})})]})})]},e.id))})]})}),M.pages>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between mt-6",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:["Showing ",(M.page-1)*M.limit+1," to"," ",Math.min(M.page*M.limit,M.total)," of"," ",M.total," venues"]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>_(e=>({...e,page:e.page-1})),disabled:1===M.page,children:[(0,t.jsx)(A.Z,{className:"h-4 w-4"}),"Previous"]}),(0,t.jsxs)("span",{className:"text-sm",children:["Page ",M.page," of ",M.pages]}),(0,t.jsxs)(c.z,{variant:"outline",size:"sm",onClick:()=>_(e=>({...e,page:e.page+1})),disabled:M.page===M.pages,children:["Next",(0,t.jsx)(k.Z,{className:"h-4 w-4"})]})]})]})]})})]})})]}),(0,t.jsx)(m.Vq,{open:U,onOpenChange:Y,children:(0,t.jsxs)(m.cZ,{className:"max-w-4xl",children:[(0,t.jsxs)(m.fK,{children:[(0,t.jsx)(m.$N,{children:"Venue Details"}),(0,t.jsx)(m.Be,{children:"Detailed information about the selected venue"})]}),V&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Name"}),(0,t.jsx)("p",{className:"text-sm",children:V.name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Slug"}),(0,t.jsx)("p",{className:"text-sm",children:V.slug})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Type"}),(0,t.jsx)(d.C,{className:es(V.venueType),children:V.venueType.replace("_"," ")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,t.jsx)(d.C,{variant:V.isActive?"default":"destructive",children:V.isActive?"Active":"Inactive"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Featured"}),(0,t.jsxs)(d.C,{variant:V.featured?"default":"outline",className:V.featured?"bg-yellow-100 text-yellow-800 border-yellow-300":"",children:[(0,t.jsx)(N.Z,{className:"h-3 w-3 mr-1 ".concat(V.featured?"fill-current":"")}),V.featured?"Featured":"Not Featured"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Capacity"}),(0,t.jsxs)("p",{className:"text-sm",children:[V.capacity," people"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Phone"}),(0,t.jsx)("p",{className:"text-sm",children:V.phone})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,t.jsx)("p",{className:"text-sm",children:V.email})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Created"}),(0,t.jsx)("p",{className:"text-sm",children:new Date(V.createdAt).toLocaleDateString()})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Address"}),(0,t.jsxs)("p",{className:"text-sm",children:[V.address,", ",V.city,", ",V.postcode]})]}),V.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Description"}),(0,t.jsx)("p",{className:"text-sm",children:V.description})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Total Bookings"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:V._count.bookings})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Tables"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:V._count.tables})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Events"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:V._count.events})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-500",children:"Owner"}),(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,t.jsxs)("p",{className:"font-medium",children:[V.owner.firstName," ",V.owner.lastName]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:V.owner.email})]})]})]}),(0,t.jsx)(m.cN,{children:(0,t.jsx)(c.z,{variant:"outline",onClick:()=>Y(!1),children:"Close"})})]})}),(0,t.jsx)(u.aR,{open:q,onOpenChange:G,children:(0,t.jsxs)(u._T,{children:[(0,t.jsxs)(u.fY,{children:[(0,t.jsx)(u.f$,{children:"Delete Venue"}),(0,t.jsxs)(u.yT,{children:['Are you sure you want to delete "',null==H?void 0:H.name,'"? This action cannot be undone and will also delete all associated bookings, tables, and events.']})]}),(0,t.jsxs)(u.xo,{children:[(0,t.jsx)(u.le,{onClick:()=>J(null),children:"Cancel"}),(0,t.jsx)(u.OL,{onClick:()=>H&&X(H.id),className:"bg-red-600 hover:bg-red-700",children:"Delete Venue"})]})]})})]})}},44:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9205).Z)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},1047:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},3774:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9205).Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},6595:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9205).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])}},function(e){e.O(0,[8590,7648,429,7025,8166,9856,7108,2971,2117,1744],function(){return e(e.s=4411)}),_N_E=e.O()}]);